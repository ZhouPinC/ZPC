## 实现计划

### 1. 核心逻辑修复：AudioRecorder.java
- 增加WAV格式支持，确保录音文件可以正常播放和分享
- 修复ANR崩溃问题，限制UI更新频率为每40ms一次
- 实现PCM到WAV的转换逻辑
- 优化文件管理，使用临时文件保存PCM数据，录音结束后转换为WAV

### 2. 首页设计：MainActivity
- 修改activity_main.xml，实现白盒子磨砂感组件
- 调整卡片背景色为#1A000000，与展开后的初始背景色保持一致
- 优化点击事件，添加权限检查

### 3. 全屏录音组件：RecorderDialogFragment
- 实现DialogFragment的全屏模式
- 添加自定义进场动画，模拟从中心放大的效果
- 实现点击空白处关闭的功能
- 添加计时器和录音状态显示
- 实现按钮的缩放动画效果
- 支持点击和长按录音模式

### 4. 波形视图改进：AudioWaveformView
- 实现从右向左流动的波形效果
- 严格按照6dp间隔和58dp最大高度设计
- 完善clear()方法，用于清除波形数据
- 采用iOS风格的红色波形条和圆角设计

### 5. 资源文件
- 创建进场动画资源scale_up_enter.xml
- 更新styles.xml，添加DialogAnimation样式
- 创建录音按钮的背景资源
- 优化麦克风图标资源

### 6. 测试和验证
- 测试录音功能是否正常工作
- 测试录音文件是否可以正常播放
- 测试展开动画和关闭功能
- 测试波形显示是否符合要求
- 测试权限请求和处理

## 实现步骤

1. 首先修改AudioWaveformView.java，完善波形视图功能
2. 然后修改AudioRecorder.java，实现WAV格式支持和防崩溃逻辑
3. 创建和更新资源文件
4. 修改MainActivity.java和activity_main.xml，实现白盒子首页
5. 实现RecorderDialogFragment.java和dialog_recorder_fullscreen.xml，实现全屏录音组件
6. 测试和验证所有功能

这个计划将按照用户提供的设计方案，完整实现录音功能的重新设计，解决ANR崩溃问题，并实现白盒子到黑盒子的平滑过渡效果。