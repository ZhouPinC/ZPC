## 实现计划

### 1. 创建资源文件

**Drawable资源**（放在 `res/drawable`）：
- `bg_recorder_dialog.xml`：深灰色圆角背景
- `bg_record_btn_outer.xml`：按钮外圈
- `bg_record_btn_inner_stop.xml`：录音状态下的按钮内圈
- `bg_record_btn_inner_rec.xml`：停止状态下的按钮内圈

**布局文件**（放在 `res/layout`）：
- `fragment_recorder.xml`：录音对话框的布局文件

### 2. 实现核心组件

**创建 `RecordDialogFragment.java`**：
- 实现一个全屏透明的 `DialogFragment` 作为录音的黑盒子容器
- 添加录音控制逻辑（开始/停止录音）
- 实现计时器功能
- 添加背景变暗和波形图显示的动效
- 实现历史记录列表的显示

### 3. 修改现有代码

**修改 `MainActivity.java`**：
- 移除当前的录音按钮和波形显示
- 添加一个悬浮按钮来打开录音对话框
- 更新权限请求逻辑

**检查 `AudioRecorder.java`**：
- 确保WAV文件头写入逻辑正常工作
- 确保录音文件保存路径正确

### 4. 功能实现

- 点击或按住录音按钮开始录音
- 录音时显示波形图和计时器
- 停止录音时保存为WAV文件
- 点击历史记录按钮显示录音列表
- 支持点击外部区域关闭对话框

### 5. 视觉效果

- 深色半透明背景（模拟iOS风格blur效果）
- 圆角设计
- 白色文字
- 平滑的过渡动画

### 6. 测试验证

- 测试录音功能是否正常
- 测试录音文件是否可以正常播放
- 测试历史记录功能是否正常
- 测试UI动效是否流畅

这个计划将按照用户提供的架构设计，将录音功能封装成一个简洁、美观的黑盒子悬浮组件，既保持了界面的整洁，又增强了工具属性。